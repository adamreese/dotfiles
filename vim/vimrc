" =======================================================================
" vimrc {{{1
" =======================================================================

if has('vim_starting') | set encoding=utf-8 nobomb | endif
scriptencoding utf-8

" -----------------------------------------------------------------------
" Environment: {{{1
" -----------------------------------------------------------------------

" Create global config for cache and data directories
let s:editor    = has('nvim') ? 'nvim' : 'vim'
let g:cache_dir = expand('$HOME/.cache/' . s:editor)
let g:data_dir  = expand('$HOME/.local/share/' . s:editor)
let g:state_dir = expand('$HOME/.local/state/' . s:editor)
let g:vim_dir   = fnamemodify(resolve(expand('<sfile>')), ':p:h')

" -----------------------------------------------------------------------
" Plug: {{{1
" -----------------------------------------------------------------------
call ar#plug#EnsureManager()

" Conditionally load plugins.
" https://github.com/junegunn/vim-plug/wiki/tips#conditional-activation
function! PlugIf(condition, ...) abort
  let l:opts = get(a:000, 0, {})
  return a:condition ? l:opts : extend(l:opts, { 'on': [], 'for': [] })
endfunction

call plug#begin(g:vim_dir . '/vendor')

let g:bufferize_command = 'tabnew'
Plug 'AndrewRadev/bufferize.vim',      { 'on': [ 'Bufferize' ] }
Plug 'Shougo/context_filetype.vim'

let g:echodoc_enable_at_startup  = 1
let g:echodoc#type = 'virtual'
Plug 'Shougo/echodoc.vim'

let g:matchup_matchparen_deferred = 1
let g:matchup_matchparen_status_offscreen = 0
let g:matchup_matchparen_deferred_show_delay = 100
Plug 'andymass/vim-matchup'
Plug 'benekastah/neomake',             { 'on': 'Neomake' }
Plug 'blueyed/vim-qf_resize'
Plug 'chrisbra/unicode.vim',           {'on': ['UnicodeName', 'UnicodeTable']}
Plug 'christoomey/vim-tmux-navigator', PlugIf(exists('$TMUX'))
Plug 'editorconfig/editorconfig-vim'
Plug 'filipekiss/cursed.vim'
Plug 'haya14busa/incsearch.vim'
Plug 'iamcco/markdown-preview.nvim', { 'do': { -> 'cd app && yarn install' }, 'for': 'markdown' }
Plug 'itchyny/lightline.vim'
Plug 'windwp/nvim-autopairs'
Plug 'junegunn/fzf'
Plug 'junegunn/fzf.vim'
Plug 'junegunn/vim-easy-align',        { 'on': ['<Plug>(EasyAlign)', 'EasyAlign'] }
Plug 'lewis6991/gitsigns.nvim'
Plug 'ludovicchabant/vim-gutentags'
Plug 'lvht/tagbar-markdown'
Plug 'majutsushi/tagbar',              { 'on': 'TagbarToggle' }
Plug 'mileszs/ack.vim'
Plug 'norcalli/nvim-colorizer.lua'
Plug 'nvim-lua/plenary.nvim'
Plug 'osyo-manga/vim-anzu'
Plug 'preservim/nerdtree'
Plug 'romainl/vim-qf'
Plug 'sbdchd/neoformat',               { 'on': 'Neoformat' }
Plug 'towolf/vim-helm'
Plug 'tpope/vim-abolish'
Plug 'tpope/vim-commentary'
Plug 'tpope/vim-eunuch'
Plug 'tpope/vim-repeat'
Plug 'tpope/vim-scriptease'
Plug 'tpope/vim-surround'
Plug 'tweekmonster/startuptime.vim'

Plug 'nvim-treesitter/nvim-treesitter', {'do': ':TSUpdate'}
Plug 'nvim-treesitter/nvim-treesitter-textobjects'

let g:colorswatch_exclusion_pattern = 'LightLine.\+'
Plug 'cocopon/colorswatch.vim',     { 'on': ['ColorSwatchGenerate', 'Inspecthi'] }

nnoremap <silent> zs :<C-U>Inspecthi<CR>
Plug 'cocopon/inspecthi.vim', { 'on': [ 'Inspecthi' ] }

" -- Version Control ---------------------------------------------------
Plug 'rhysd/committia.vim'
Plug 'tpope/vim-fugitive'
Plug 'tpope/vim-git'
Plug 'tpope/vim-rhubarb'

" -- Languages ----------------------------------------------------------
Plug 'PotatoesMaster/i3-vim-syntax'
Plug 'cespare/vim-toml'
Plug 'chrisbra/vim-sh-indent'
Plug 'chrisbra/vim-zsh'
Plug 'elzr/vim-json'
Plug 'fatih/vim-go'
Plug 'jparise/vim-graphql'
Plug 'leafgarland/typescript-vim'
Plug 'neoclide/jsonc.vim'
Plug 'othree/es.next.syntax.vim'
Plug 'othree/yajs.vim'
Plug 'pangloss/vim-javascript', PlugIf(v:false)
Plug 'plasticboy/vim-markdown'
Plug 'rhysd/vim-wasm'
Plug 'rust-lang/rust.vim'
Plug 'tmux-plugins/vim-tmux'
Plug 'towolf/vim-helm'
Plug 'uarun/vim-protobuf'
Plug 'vim-ruby/vim-ruby'

Plug 'tweekmonster/exception.vim'
command! WTF call exception#trace()

" -- LSP ----------------------------------------------------------------
if has('nvim-0.5.0')
  Plug 'neovim/nvim-lspconfig'
  Plug 'nvim-lua/lsp-status.nvim'
  Plug 'ojroques/nvim-lspfuzzy'
  Plug 'L3MON4D3/LuaSnip'
  Plug 'rafamadriz/friendly-snippets'
  Plug 'simrat39/rust-tools.nvim'
  Plug 'folke/lua-dev.nvim'
  Plug 'b0o/SchemaStore.nvim'

  Plug 'hrsh7th/nvim-cmp'
  Plug 'hrsh7th/cmp-path'
  Plug 'hrsh7th/cmp-buffer'
  Plug 'hrsh7th/cmp-nvim-lsp'
  Plug 'f3fora/cmp-spell'
  Plug 'hrsh7th/cmp-nvim-lua'
  Plug 'saadparwaiz1/cmp_luasnip'
  Plug 'hrsh7th/cmp-cmdline'
endif

call plug#end()

" -----------------------------------------------------------------------
" Map Leader: {{{1
" -----------------------------------------------------------------------

let g:mapleader = ','
let g:maplocalleader = ','
